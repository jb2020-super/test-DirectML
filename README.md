# Test DirectML operators 
## Identity Op
## Convolution Op

### Convolution Performance

#### DirectML v1.0

| Device      | Conv_No_op(ns) | Conv(ns) | Conv+Relu | Conv+Tanh | Conv+Sigmoid | Conv+LeakyRelu |
| ----------- | -------------- | -------- | --------- | --------- | ------------ | -------------- |
| AMD 5700 XT | 148,160        | NA       | 148,080   | 191,400   | 191,880      | 148,360        |
| RTX 3090    | 318,016        | 45,120   | 48,096    | 57,088    | 48,074       | 47,296         |

#### DirectML v1.5.1

| Device      | Conv_No_op(ns) | Conv(ns) | Conv+Relu | Conv+Tanh | Conv+Sigmoid | Conv+LeakyRelu |
| ----------- | -------------- | -------- | --------- | --------- | ------------ | -------------- |
| AMD 5700 XT | 155,400        | NA       | 154,760   | 154,560   | 183,600      | 155,480        |
| RTX 3090    | 318,016        | 40,704   | 39,456    | 48,384    | 49,376       | 40,704         |

- RTX 3090

<img src="\test\3090-conv.PNG" style="zoom:50%;" />

- RTX 3090 with optimize

<img src="\test\3090-conv-optimized.PNG" style="zoom:50%;" />

- AMD 5700 XT

<img src="\test\5700xt_conv.PNG" style="zoom:50%;" />

## Transposed Convolution Op
```tex
Input Dimension: 10x10
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618   1.618
Filter Dimension: 4x4
1       1       1       1
1       1       1       1
1       1       1       1
1       1       1       1
Output Dimension: 16x16
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472   6.472  6.472
```